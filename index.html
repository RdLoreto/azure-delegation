<!DOCTYPE html>
<html>
<head>
  <title>Azure Billing Reader POC</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; }
    .card { padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
    .btn { 
      display: inline-block; padding: 12px 24px; margin: 10px 5px;
      background: #0078d4; color: white; text-decoration: none; 
      border-radius: 4px; border: none; cursor: pointer;
    }
    .btn-verify { background: #107c10; }
    .warning { color: #d83b01; font-weight: bold; }
    #result { 
      padding: 15px; margin-top: 20px; border-radius: 4px; 
      display: none; border: 1px solid transparent;
    }
    .success { background: #dff6dd; border-color: #107c10; }
    .error { background: #fde7e9; border-color: #a80000; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Azure Billing Reader POC</h1>
    <p class="warning">⚠️ THIS IS A PROOF OF CONCEPT ONLY ⚠️</p>
    
    <h2>1. Grant Access</h2>
    <p>Click below to delegate <strong>Billing Reader</strong> permissions:</p>
    <a href="https://portal.azure.com/#create/Microsoft.Template/uri/https://raw.githubusercontent.com/YOUR_GITHUB_USERNAME/YOUR_REPO/main/billing-poc.json" 
       target="_blank" class="btn" id="grantBtn">
      Grant Access via Azure Portal
    </a>
    
    <h2>2. Verify Access</h2>
    <button class="btn btn-verify" id="verifyBtn">Check Access Now</button>
    <div id="result"></div>
    
    <div id="manualSteps" class="hidden">
      <h3>Manual Verification Steps:</h3>
      <ol>
        <li>Go to <a href="https://portal.azure.com" target="_blank">Azure Portal</a></li>
        <li>Navigate to: <strong>Subscriptions → [Your Subscription] → Access Control (IAM)</strong></li>
        <li>Search for "<strong>PocBillingReader</strong>"</li>
      </ol>
    </div>
  </div>

  <script>
    // Verify by opening Azure Portal directly
    document.getElementById('verifyBtn').addEventListener('click', () => {
      const subId = prompt("Enter your Azure Subscription ID:");
      if (!subId) return;
      
      // Open Azure Portal to consumption data
      window.open(
        `https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade/subscriptionId/%2Fsubscriptions%2F${subId}`,
        '_blank'
      );
      
      // Show manual steps as fallback
      document.getElementById('manualSteps').classList.remove('hidden');
      
      // Show result message
      const result = document.getElementById('result');
      result.style.display = 'block';
      result.innerHTML = `
        <p>✅ Verification initiated in new tab.</p>
        <p>If you see billing data, access is working.</p>
        <p>If you see errors, complete the <strong>Grant Access</strong> step first.</p>
      `;
    });
    
    // Auto-populate subscription ID if available (for demo purposes)
    document.getElementById('grantBtn').addEventListener('click', () => {
      localStorage.setItem('lastClicked', new Date().toISOString());
    });
  </script>
</body>
</html>
